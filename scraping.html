<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Scraping</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<meta name="robots" content="index, follow">
<link rel="stylesheet" href="./include/analyse-R.css" />
<script type="text/javascript" src="./libs/zeroclipboard-2.2.0/ZeroClipboard.js"></script>
<link rel="stylesheet" href="./libs/colorbox-1.6.1/colorbox.css" />
<script type="text/javascript" src="./libs/colorbox-1.6.1/jquery.colorbox-min.js"></script>
<!--- favicon --->
<link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
<link rel="manifest" href="./images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121727005-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121727005-1');
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->





<nav>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href=".">analyse-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="manipuler" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Manipuler <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_manipuler">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Prise en main</li>
                  <li><a href="presentation-et-philosophie.html">Présentation et Philosophie</a></li>
                  <li><a href="installation-de-R-et-RStudio.html">Installation de <strong>R</strong> et <strong>RStudio</strong></a></li>
                  <li><a href="premier-contact.html">Premier contact</a></li>
                  <li><a href="premier-travail-avec-les-donnees.html">Premier travail avec des données</a></li>
                  <li><a href="extensions.html">Extensions (installation, mise à jour)</a></li>
                  <li><a href="introduction-au-tidyverse.html">Introduction au <strong>tidyverse</strong></a></li>
                  <li><a href="vecteurs-indexation-et-assignation.html">Vecteurs, indexation et assignation</a></li>
                  <li><a href="listes-et-tableaux-de-donnes.html">Listes et Tableaux de données</a></li>
                  <li><a href="facteurs-et-vecteurs-labellises.html">Facteurs et vecteurs labellisés</a></li>
                  <li><a href="organiser-ses-fichiers.html">Organiser ses fichiers</a></li>
                  <li><a href="import-de-donnees.html">Import de données</a></li>
                  <li><a href="ou-trouver-de-l-aide.html">Où trouver de l'aide ?</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Manipulation de données</li>
  		            <li><a href="visualiser-ses-donnees.html">Visualiser ses données</a></li>
  		            <li><a href="recodage.html">Recodage de variables</a></li>
                  <li><a href="manipuler-les-donnees-avec-dplyr.html">Manipuler les données avec <strong>dplyr</strong></a></li>
                  <li><a href="manipulations-avancees-avec-data-table.html">Manipulations avancées avec <strong>data.table</strong></a></li>
                  <li><a href="tris.html">Tris</a></li>
                  <li><a href="sous-ensembles.html">Sous-ensembles</a></li>
                  <li><a href="fusion-de-tables.html">Fusion de tables</a></li>
                  <li><a href="gestion-des-dates.html">Gestion des dates</a></li>
                  <li><a href="fonctions-a-fenetre.html">Fonctions à fenêtre</a></li>
                  <li><a href="manipuler-du-texte.html">Manipuler du texte avec <strong>stringr</strong></a></li>
                  <li><a href="reorganiser-ses-donnees-avec-tidyr.html">Réorganiser ses données avec <strong>tidyr</strong></a></li>
                  <li><a href="scraping.html">Scraping</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Exporter</li>
                  <li><a href="export-de-donnees.html">Export de données</a></li>
                  <li><a href="export-de-graphiques.html">Export de graphiques</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="analyser" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Analyser <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_analyser">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques introductives</li>
                  <li><a href="statistique-univariee.html">Statistique univariée</a></li>
                  <li><a href="statistique-bivariee.html">Statistique bivariée</a></li>
                  <li><a href="intro-ggplot2.html">Introduction à <strong>ggplot2</strong>, la grammaire des graphiques</a></li>
                  <li><a href="graphiques-bivaries-ggplot2.html">Graphiques univariés et bivariés avec <strong>ggplot2</strong></a></li>
                  <li><a href="donnees-ponderees.html">Données pondérées</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques intermédiaires</li>
  		            <li><a href="intervalles-de-confiance.html">Intervalles de confiance</a></li>
                  <li><a href="comparaisons-moyennes-et-proportions.html">Comparaisons (moyennes et proportions)</a></li>
                  <li><a href="definir-un-plan-d-echantillonnage-complexe.html">Définir un plan d'échantillonnage complexe</a></li>
                  <li class="dev"><a href="regression-lineaire.html">Régression linéaire</a></li>
                  <li><a href="regression-logistique.html">Régression logistique binaire, multinomiale et ordinale</a></li>
                  <li><a href="analyse-des-correspondances-multiples.html">Analyse des correspondances multiples (ACM)</a></li>
                  <li><a href="classification-ascendante-hierarchique.html">Classification ascendante hiérarchique (CAH)</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Statistiques avancées</li>
                  <li><a href="effets-d-interaction.html">Effets d'interaction dans un modèle</a></li>
                  <li><a href="multicolinearite.html">Multicolinéarité dans la régression</a></li>
                  <li><a href="analyse-de-survie.html">Analyse de survie</a></li>
                  <li><a href="analyse-de-sequences.html">Analyse de séquences</a></li>
                  <li><a href="trajectoires-de-soins.html">Trajectoires de soins&nbsp;: données longitudinales, analyse de séquences, modèle multinomial, modèle à temps discret, modèles de survie classiques et multi-états</a></li>
                  <li><a href="analyse-de-reseaux.html">Analyse de réseaux</a></li>
                  <li><a href="analyse-spatiale.html">Analyse spatiale</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="approfondir" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Approfondir <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_approfondir">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Graphiques</li>
                  <li><a href="ggplot2.html">ggplot2 et la grammaire des graphiques</a></li>
                  <li><a href="combiner-plusieurs-graphiques.html">Combiner plusieurs graphiques</a></li>
                  <li><a href="graphiques-interactifs.html">Graphiques interactifs</a></li>
                  <li><a href="lattice-graphiques-et-formules.html"><strong>lattice</strong> : graphiques et formules</a></li>
                  <li><a href="cartes.html">Cartes</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Programmation</li>
  		            <li><a href="conditions-et-comparaisons.html">Conditions et comparaisons</a></li>
                  <li><a href="formules.html">Formules</a></li>
                  <li><a href="structures-conditionnelles.html">Structures conditionnelles</a></li>
                  <li><a href="vectorisation.html">Vectorisation</a></li>
                  <li><a href="expressions-regulieres.html">Expressions régulières</a></li>
                  <li class="dev"><a href="ecrire-ses-propres-fonctions.html">Écrire ses propres fonctions</a></li>
                  <li><a href="rmarkdown-les-rapports-automatises.html"><strong>R Markdown</strong> : les rapports automatisés</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Divers</li>
                  <li><a href="calculer-un-age.html">Calculer un âge</a></li>
                  <li class="dev"><a href="diagramme-de-lexis.html">Diagramme de Lexis</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="index" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Index <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="menu_naviguer">
            <li><a href="index-des-concepts.html">Index des concepts</a></li>
            <li><a href="index-des-fonctions.html">Index des fonctions</a></li>
            <li><a href="index-des-extensions.html">Index des extensions</a></li>
          </ul>
        </li>
        <li><a href="analyse-R.pdf">PDF</a></li>
      </ul>
    <form id="rechercher" class="navbar-form navbar-right" role="search" style="padding-top: 5px;" method="get" action="https://tontonroger.org/">
      <div class="form-group">
        <input name="q" type="text" class="form-control input-sm" placeholder="Rechercher">
      </div>
      <button type="submit" class="btn btn-default btn-sm" name="Rechercher">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </button>
    </form>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
</nav>

<div class="row">

<a href="https://github.com/larmarange/analyse-R"><img style="position: absolute; top: 60px; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Contribuer sur GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>

<div class="col-sm-9" role="main">
<article>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Scraping</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#les-sources-de-lexemple">Les sources de l’exemple</a><ul>
<li><a href="#les-blogs">Les blogs</a></li>
<li><a href="#les-mots-cles">Les mots-clés</a></li>
</ul></li>
<li><a href="#recuperation-des-donnees">Récupération des données</a><ul>
<li><a href="#recuperation-delements-html">Récupération d’éléments HTML</a></li>
<li><a href="#recuperation-de-plusieurs-pages">Récupération de plusieurs pages</a></li>
<li><a href="#utilisation-de-la-syntaxe-xpath">Utilisation de la syntaxe XPath</a></li>
</ul></li>
<li><a href="#combinaison-des-resultats">Combinaison des résultats</a></li>
</ul>
</div>

<p>Une grande partie des données que l’on trouve sur Internet n’y sont pas présentées sous la forme d’un jeu de données : dans de très nombreux cas de figure, ces données peuvent être présentées, par exemple, sous la forme d’un tableau, ou d’une série de pages Web. Ce chapitre explique comment récupérer ces données, de manière à en permettre la manipulation dans <strong>R</strong>.</p>
<p>La récupération de données numériques, que l’on va illustrer à partir de trois sites Internet consacrés aux théories du complot circulant en France, est plus connue sous le nom de <em>scraping</em> ou de <em><a href="https://en.wikipedia.org/wiki/Web_scraping">Web scraping</a></em>. Il s’agit d’un ensemble de techniques, dont on présentera ici que les principaux aspects, appliqués à un cas d’étude précis.</p>
<div id="les-sources-de-lexemple" class="section level2">
<h2>Les sources de l’exemple</h2>
<p>Ce chapitre s’intéresse à trois sites Internet consacrés aux théories du complot et à leurs diffuseurs, les « conspirationnistes ». Le site de Rudy Reichstadt, <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a>, qui va devenir notre principale source de données, propose une <a href="http://www.conspiracywatch.info/F-A-Q_r11.html">définition de ce terme</a>. La seconde source utilisée, le site <a href="http://confusionnisme.info/">Confusionnisme</a> d’Ornella Guyet, utilise une <a href="http://confusionnisme.info/vous-avez-dit-confusionnisme/">définition différente</a>, qui recoupe largement la première du point de vue des individus et des groupes qu’elle identifie. Notre troisième source, le site anonyme <a href="http://conspishorsdenosvies.noblogs.org/">Conspis hors de nos vi[ll]es</a>, ne propose pas de définition précise pour sa part, mais fournit <a href="http://conspishorsdenosvies.noblogs.org/qui-sommes-nous/">quelques éléments supplémentaires de description</a>.</p>
<p>Les termes de « théorie du complot » et de « conspirationnisme » étant difficiles à saisir en seulement quelques phrases, on renverra le lecteur à la <a href="http://www.jean-jaures.org/Publications/Notes/Conspirationnisme-un-etat-des-lieux">note publiée par Rudy Reichstadt</a> pour l’Observatoire des radicalités politiques de la Fondation Jean Jaurès. Cette note donne un bon aperçu des différents groupes impliqués dans la diffusion de ces « théories » en France, que l’on retrouve dans une <a href="http://www.joelgombin.fr/mapping-the-french-conspiracist-web-key-findings/">cartographie en réseau</a> de leurs sites Internet, réalisée par Joël Gombin en juillet 2014. Les données récupérées dans ce chapitre recoupent les informations fournies dans ces deux sources.</p>
<div id="les-blogs" class="section level3">
<h3>Les blogs</h3>
<p>Les sites Internet auxquels on s’intéresse sont tous les trois publiés sous la forme de blogs. Ce détail est important, car pour en récupérer les informations publiées par ces sites, il va falloir comprendre la structure sous-jacente de ces blogs, c’est-à-dire la syntaxe HTML de leurs pages. Les sites <a href="http://confusionnisme.info/">Confusionnisme</a> et <a href="http://conspishorsdenosvies.noblogs.org/">Conspis hors de nos vi[ll]es</a> sont les plus simples à comprendre. En effet, ils sont tous les deux publiés grâce au moteur de blog <a href="http://wordpress.org/">WordPress</a>, qui permet de parcourir les différentes pages d’un blog en rajoutant le suffixe <code>/page/n</code> à l’adresse-racine du site, de la manière suivante :</p>
<pre><code>http://confusionnisme.info/page/1
http://confusionnisme.info/page/2
http://confusionnisme.info/page/3
...
http://conspishorsdenosvies.noblogs.org/page/1
http://conspishorsdenosvies.noblogs.org/page/2
http://conspishorsdenosvies.noblogs.org/page/3
...</code></pre>
<p>En navigant ces liens, on s’aperçoit que les deux sites en question n’ont publié qu’un nombre limité de billets : il n’y a que 4 pages de billets sur le premier, et 5 pages sur le second. Le site <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a> est, en comparaison, beaucoup plus riche : en effet, comme l’indique le compteur visible en bas de chaque page, le site compte 60 pages de billets, auxquelles le lecteur peut accéder en utilisant un suffixe différent, lié à l’utilisation d’un moteur de blog différent de WordPress. Dans ce cas de figure, le suffixe ne renvoie pas à une « page », mais à un « compteur » de billets, où le dernier billet publié est numéroté <code>0</code> :</p>
<pre><code>http://www.conspiracywatch.info/?start=0
http://www.conspiracywatch.info/?start=20
http://www.conspiracywatch.info/?start=40
...</code></pre>
<p>Suivant ce schéma de pagination, qui commence à <code>0</code> puis augmente de 20 billets par page, la page <code>60</code> va correspondre au suffixe <code>?start=1180</code>. On connaît donc désormais le nombres de pages à récupérer sur chacun des blogs étudiés, en notant bien que c’est le site <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a> qui va fournir la très grande majorité des pages. On aurait pu « découvrir » ces informations de manière programmatique, en écrivant un peu de code pour ce faire, mais un repérage manuel du nombre de pages sur chacun des blogs est ici tout aussi rapide, même s’il faudra le mettre à jour lorsque les blogs auront publié de nouvelles pages de billets.</p>
</div>
<div id="les-mots-cles" class="section level3">
<h3>Les mots-clés</h3>
<p>Sur chacun des blogs auxquels on s’intéresse, on trouve des billets très détaillés sur tel ou tel groupe diffusant une ou plusieurs « théories du complot ». Sur les blogs <a href="http://confusionnisme.info/">Confusionnisme</a> et <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a>, on trouve par exemple <a href="http://www.conspiracywatch.info/Mouvement-du-14-Juillet-le-pu-putsch-qui-fait-flop_a1427.html">deux</a> <a href="http://confusionnisme.info/2015/07/15/le-petard-mouille-du-14-juillet/">articles</a> sur un groupuscule ayant appelé à un « Mouvement du 14 juillet » 2015. Sur le blog <a href="http://conspishorsdenosvies.noblogs.org/">Conspis hors de nos vi[ll]es</a>, qui a cessé de publier en mars 2012, le <a href="http://conspishorsdenosvies.noblogs.org/post/2012/03/30/les-ideologues-de-la-contre-revolution-sinvitent-a-lageca-et-on-devrait-laisser-faire-ca/">dernier billet</a> évoque un autre exemple de ces groupes. Ces différents billets sont tous soigneusement catégorisés par de très nombreux mots-clés, qui incluent notamment les noms propres des individus cités ; <a href="http://www.conspiracywatch.info/Laurent-Louis-a-propos-du-premier-pas-de-l-homme-sur-la-Lune_a1419.html">ce billet</a>, par exemple, se termine par les mots-clés suivants :</p>
<pre><code>11 septembre, antiaméricanisme, apollo 11, etat islamique, etats-unis, laurent louis, lune</code></pre>
<p>Ces mots-clés sont destinés à permettre aux lecteurs de naviguer plus facilement à travers les différents billets du site, ainsi qu’à faciliter l’indexation du blog par les moteurs de recherche. Ce que l’on se propose de faire ici consiste à récupérer, pour chacun des billets publiés par chacun des trois blogs, l’ensemble de ces mots-clés, ainsi que les titres, les dates de publication et les adresses Internet – les <a href="https://fr.wikipedia.org/wiki/Uniform_Resource_Locator">URL</a> – des billets auxquels ils correspondent. Ces données permettront par la suite de construire un <a href="https://en.wikipedia.org/wiki/Co-occurrence_networks">réseau de co-occcurrences</a> de ces mots-clés, c’est-à-dire une représentation graphique des associations entre ces mots-clés sur la base des trois sources utilisées.</p>
</div>
</div>
<div id="recuperation-des-donnees" class="section level2">
<h2>Récupération des données</h2>
<p>Pour récupérer les données des trois blogs, on va commencer par charger quelques extensions utilisées dans plusieurs autres chapitres : l’extension <code class="pkg">dplyr</code> va servir à manipuler les données au fur et à mesure de leur récupération ; l’extension <code class="pkg">readr</code> va servir à sauvegarder le résultat final au format CSV ; l’extension <code class="pkg">lubridate</code> va servir à convertir les dates de publication des billets vers un même format générique ; et l’extension <code class="pkg">stringr</code> va servir à nettoyer le texte récupéré.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(readr)
<span class="kw">library</span>(lubridate)
<span class="kw">library</span>(stringr)</code></pre></div>
<p>Chargeons à présent l’extension <code class="pkg">rvest</code>, qui va fournir les fonctions essentielles à la récupération des données de chacun des blogs. Comme <a href="https://cran.r-project.org/web/packages/rvest/README.html">l’explique</a> l’auteur de l’extension, celle-ci est inspirée d’extensions équivalentes disponibles pour le langage Python. Sa fonctionnalité principale est de permettre à l’utilisateur, à l’aide d’une syntaxe simplifiée ou à l’aide de la syntaxe <a href="https://fr.wikipedia.org/wiki/XPath">XPath</a>, de sélectionner les différents éléments d’une page Web, à partir des balises <a href="https://fr.wikipedia.org/wiki/Hypertext_Markup_Language">HTML</a> et <a href="https://fr.wikipedia.org/wiki/Feuilles_de_style_en_cascade">CSS</a> de cette page.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rvest)</code></pre></div>
<div id="recuperation-delements-html" class="section level3">
<h3>Récupération d’éléments HTML</h3>
<p>Commençons par le blog <a href="http://confusionnisme.info/">Confusionnisme</a>. Un rapide coup d’oeil au <a href="view-source:http://confusionnisme.info/">code source de sa page d’accueil</a> montre que les billets publiés sur ce blog se trouvent dans une suite de structures : l’une d’entre elles, <code>&lt;div id=&quot;content&quot;&gt;</code>, qui se lit « diviseur à identifiant <code>content</code> », contient tous les billets, et à l’intérieur de cette structure, tous les titres de billets se trouvent dans un hyperlien <code>&lt;a&gt;</code> à l’intérieur d’une balise <code>&lt;h1 class=&quot;entry-title&quot;&gt;</code>, qui se lit « titre de niveau 1 de classe « entry-title ».</p>
<p>Récupérons désormais le code source de la page d’accueil du blog grâce à la fonction <code data-pkg="rvest">html</code>. Une fois exécuté le code ci-dessous, affichez le contenu de l’objet <code>h</code> pour réaliser que vous venez de récupérer le code source HTML de la page d’accueil du blog :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">h =<span class="st"> </span><span class="kw">html</span>(<span class="st">&quot;http://confusionnisme.info/&quot;</span>)</code></pre></div>
<p>Sélectionnons, à présent, toutes les balises correspondant aux identifiants notés ci-dessus, grâce à la fonction <code data-pkg="rvest">html_nodes</code>. Pour gagner de la place, on n’affichera ici que les deux premiers titres de billets que renvoie cette dernière fonction :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">&quot;#content .entry-title a&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">2</span>)</code></pre></div>
<p>Le code ci-dessus signifie : « sélectionner tous les hyperliens <code>&lt;a&gt;</code>, à l’intérieur des éléments identifiés par la classe <code>entry-title</code>, à l’intérieur de l’élément portant l’identifiant <code>content</code> ». Comme l’on peut le voir, les identifiants des éléments HTML (<code>id</code>), qui sont censés être uniques, sont codés par un dièse (<code>#</code>), et les classes de ces mêmes éléments (<code>class</code>), qui peuvent se répéter, sont codées par un point (<code>.</code>). Ces codes sont identiques à ceux que l’on utilise pour attribuer des styles particuliers à ces éléments en langage CSS.</p>
<p>Les éléments HTML que l’on a sélectionnés contiennent aussi bien des balises HTML (telles que <code>&lt;a&gt;</code> et <code>&lt;i&gt;</code>) que du texte. Pour ne sélectionner que le texte, on rajoute la fonction <code data-pkg="rvest">html_text</code> au code montré ci-dessus. Toujours par économie de place, on ne montre que les deux premiers résultats de ce nouvel enchaînement de fonctions :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">&quot;#content .entry-title a&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>html_text <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">2</span>)</code></pre></div>
<p>Voilà qui permet donc de récupérer les titres des billets ! Pour récupérer les hyperliens vers ces billets, rien de plus simple : au lieu de récupérer le texte des titres, il suffit de demander à récupérer l’attribut <code>href</code> de chaque lien, en utilisant la fonction <code data-pkg="rvest">html_attr</code>. On obtient cette fois-ci les hyperliens complets vers chaque billet :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">&quot;#content .entry-title a&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">html_attr</span>(<span class="st">&quot;href&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">2</span>)</code></pre></div>
<p>Présentons encore un exemple de sélection d’éléments sur la page d’accueil de ce blog, cette fois-ci en montrant l’intégralité des éléments récupérés, car ils prennent peu de place à l’écran. Ici, on récupère les dates de publications des billets, qui se trouvent, toujours selon le <a href="view-source:http://confusionnisme.info/">code source de la page</a>, dans une balise <code>&lt;time&gt;</code> qui se trouve dans une balise <code>&lt;header class=&quot;entry-meta&quot;&gt;</code>. Le code que l’on donne à la fonction <code data-pkg="rvest">html_nodes</code> est donc :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">&quot;#content header.entry-header time&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>html_text</code></pre></div>
<p>On voit bien ici que les deux premières dates sont identiques aux dates qui figurent dans les hyperliens des deux premiers billets, tels que vus plus haut.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">&quot;#content header.entry-header time&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>html_text</code></pre></div>
<p>Terminons, enfin, par un exemple plus compliqué. Comme on l’a déjà écrit, chacun des billets du blog est accompagné de plusieurs mots-clés. Après inspection du code source, on voit que ces mots-clés se trouvent regroupés dans un élément appelé <code>&lt;span class=&quot;tag-links&quot;&gt;</code>. Visionnons les deux premiers éléments en question, toujours à l’aide de la même syntaxe de sélection :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">&quot;.tag-links&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">head</span>(<span class="dv">2</span>)</code></pre></div>
<p>Pour pouvoir stocker tous les mots-clés d’un billet sur la même ligne d’un fichier CSV, qui contiendra aussi le titre du billet, son hyperlien et sa date de publication, il va falloir regroupr ces mots-clés. On va donc, <em>à l’intérieur de chacun des éléments</em> de la liste d’éléments <code>&lt;span&gt;</code>, extraire le texte des mots-clés, contenus dans les éléments <code>&lt;a&gt;</code>, et les “coller” ensemble grâce à la fonction <code data-pkg="base">paste0</code> et à son argument <code>collapse</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">html_nodes</span>(h, <span class="st">&quot;.tag-links&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">sapply</span>(<span class="cf">function</span>(x) <span class="kw">html_nodes</span>(x, <span class="st">&quot;a&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">           </span>html_text <span class="op">%&gt;%</span>
<span class="st">           </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">&quot;;&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">2</span>)</code></pre></div>
<p>L’astuce se trouve ici dans l’utilisation de la fonction <code data-pkg="base">sapply</code>, qui permet de travailler sur chacun des éléments <code>&lt;span class=&quot;tag-links&quot;&gt;</code> de manière séparée. L’utilisation de la fonction <em>pipe</em> <code>%&gt;%</code> a par ailleurs permis de travailler de manière cumulative, par essai-erreur, tout en produisant un code final plutôt lisible.</p>
</div>
<div id="recuperation-de-plusieurs-pages" class="section level3">
<h3>Récupération de plusieurs pages</h3>
<p>On sait désormais comment récupérer les informations que l’on veut collecter. Le blog <a href="http://confusionnisme.info/">Confusionnisme</a> n’ayant que 4 pages, il va être très simple de les récupérer à l’aide d’une petite boucle qui récupère chaque page, en extrait les données inspectées ci-dessus, et les rajoute à un jeu de données initialement vide, nommé <code>d1</code>, grâce à la fonction <code data-pkg="base">rbind</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d1 =<span class="st"> </span><span class="kw">data_frame</span>()

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {
  
  h =<span class="st"> </span><span class="kw">html</span>(<span class="kw">paste0</span>(<span class="st">&quot;http://confusionnisme.info/page/&quot;</span>, i))
  
  d1 =<span class="st"> </span><span class="kw">rbind</span>(d1, <span class="kw">data_frame</span>(
    <span class="dt">url =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;#content .entry-title a&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_attr</span>(<span class="st">&quot;href&quot;</span>),
    <span class="dt">title =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;#content .entry-title a&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text,
    <span class="dt">date =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;#content header.entry-header time&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text,
    <span class="dt">tags =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;.tag-links&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">sapply</span>(<span class="cf">function</span>(x) <span class="kw">html_nodes</span>(x, <span class="st">&quot;a&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">               </span>html_text <span class="op">%&gt;%</span>
<span class="st">               </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">&quot;;&quot;</span>))
  ))
  
}</code></pre></div>
<p>À la date de publication de ce blog, ce petit bout de code récupère les 36 billets étalés sur les 4 pages du site <a href="http://confusionnisme.info/">Confusionnisme</a>. Comme le montre l’inspection du résultat, le jeu de données que l’on vient de constituer contient l’adresse, le titre, la date de publication et les mots-clés de ces billets :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(d1)</code></pre></div>
<p>Il ne reste plus qu’à convertir la variable <var>date</var> vers le format générique <code>yyyy-mm-dd</code> que propose <strong>R</strong> à travers la fonction <code data-pkg="base">as.Date</code>. Pour convertir la variable, on utilise l’extension <code class="pkg">lubridate</code>, qui peut facilement interpréter les mois écrits en langue française grâce à l’argument <code>locale</code> spécifié ci-dessous :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d1<span class="op">$</span>date =<span class="st"> </span><span class="kw">parse_date_time</span>(d1<span class="op">$</span>date, <span class="st">&quot;%d %m %Y&quot;</span>, <span class="dt">locale =</span> <span class="st">&quot;fr_FR&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>as.Date</code></pre></div>
</div>
<div id="utilisation-de-la-syntaxe-xpath" class="section level3">
<h3>Utilisation de la syntaxe XPath</h3>
<p>L’exemple que l’on vient de voir permet de récupérer les données du blog <a href="http://confusionnisme.info/">Confusionnisme</a>. Il se trouve que ce code fonctionne presque aussi bien pour le blog <a href="http://conspishorsdenosvies.noblogs.org/">Conspis hors de nos vi[ll]es</a> : en effet, celui-ci utilisant aussi le moteur de blog WordPress, la structure de ses pages est quasiment identique à celle que l’on vient de voir. Voici le code complet pour récupérer les 5 pages de ce blog :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d2 =<span class="st"> </span><span class="kw">data_frame</span>()

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {
  
  h =<span class="st"> </span><span class="kw">html</span>(<span class="kw">paste0</span>(<span class="st">&quot;http://conspishorsdenosvies.noblogs.org/page/&quot;</span>, i))
  
  d2 =<span class="st"> </span><span class="kw">rbind</span>(d2, <span class="kw">data_frame</span>(
    <span class="dt">url =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;#content .entry-title a&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_attr</span>(<span class="st">&quot;href&quot;</span>),
    <span class="dt">title =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;#content .entry-title a&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text,
    <span class="dt">date =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;#content .entry-date&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text,
    <span class="dt">tags =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;.tag-links&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">sapply</span>(<span class="cf">function</span>(x) <span class="kw">html_nodes</span>(x, <span class="dt">xpath =</span> <span class="st">&quot;a[@rel=&#39;tag&#39;]&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">               </span>html_text <span class="op">%&gt;%</span>
<span class="st">               </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">&quot;;&quot;</span>))
  ))
  
}

d2<span class="op">$</span>date =<span class="st"> </span><span class="kw">parse_date_time</span>(d2<span class="op">$</span>date, <span class="st">&quot;%d/%m/%Y&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.Date</code></pre></div>
<p>On remarquera que plusieurs petites choses ont changé : par exemple, sur le blog <a href="http://conspishorsdenosvies.noblogs.org/">Conspis hors de nos vi[ll]es</a>, les dates sont affichées dans un format <code>dd/mm/yyyy</code> qui ne nécessite pas de conversion, car chaque élément de la date est donné sous la forme d’un chiffre. On remarquera aussi que l’emplacement de la date a changé, car le gabarit graphique du blog diffère de celui de <a href="http://confusionnisme.info/">Confusionnisme</a> et place cette information dans un élément différent du <a href="view-source:http://conspishorsdenosvies.noblogs.org/">code source de la page</a>.</p>
<p>Le changement le plus important ici concerne l’utilisation de la syntaxe <a href="https://fr.wikipedia.org/wiki/XPath">XPath</a> : en effet, pour récupérer les mots-clés, il nous a fallu limiter ceux-ci à ceux se trouvant dans des hyperliens (<code>&lt;a&gt;</code>) dont la propriété <code>rel</code> est égale à <code>tag</code>, pour ne pas également récupérer les mots-clés correspondant à des catégories du blog. La syntaxe XPath est un peu plus alambiquée : ici, c’est l’expression <code>a[@rel='tag']</code> qui accomplit l’opération souhaitée, à condition d’être bien passée à l’argument <code>xpath</code> de la fonction <code data-pkg="rvest">html_nodes</code>.</p>
</div>
</div>
<div id="combinaison-des-resultats" class="section level2">
<h2>Combinaison des résultats</h2>
<p>Il nous reste un blog à couvrir : <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a>. Le code pour celui-ci diffère assez fondamentalement des blogs précédents du point de vue de la syntaxe de ses pages, qui utilisent un moteur de blog complètement différent de WordPress. Après lecture de la source, on arrive au code suivant, qui récupère les mêmes variables que récupérées pour les deux autres blogs :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d3 =<span class="st"> </span><span class="kw">data_frame</span>()

<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1180</span>, <span class="dv">20</span>)) {
  
  h =<span class="st"> </span><span class="kw">html</span>(<span class="kw">paste0</span>(<span class="st">&quot;http://www.conspiracywatch.info/?start=&quot;</span>, i))
  
  d3 =<span class="st"> </span><span class="kw">rbind</span>(d3, <span class="kw">data_frame</span>(
    <span class="dt">url =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;#mod_1260437 .titre a&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_attr</span>(<span class="st">&quot;href&quot;</span>),
    <span class="dt">title =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;#mod_1260437 .titre&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text <span class="op">%&gt;%</span><span class="st"> </span>str_trim,
    <span class="dt">date =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;#mod_1260437 .cel_pied .date&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>html_text,
    <span class="dt">tags =</span> <span class="kw">html_nodes</span>(h, <span class="st">&quot;#mod_1260437 .cel_pied&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">sapply</span>(<span class="cf">function</span>(x) <span class="kw">html_nodes</span>(x, <span class="st">&quot;.objet-tag a&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">               </span>html_text <span class="op">%&gt;%</span>
<span class="st">               </span><span class="kw">paste0</span>(<span class="dt">collapse =</span> <span class="st">&quot;;&quot;</span>))
  ))
  
}

d3<span class="op">$</span>url =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;http://www.conspiracywatch.info&quot;</span>, d3<span class="op">$</span>url)
d3<span class="op">$</span>date =<span class="st"> </span><span class="kw">parse_date_time</span>(d3<span class="op">$</span>date, <span class="st">&quot;%d %m %Y&quot;</span>, <span class="dt">locale =</span> <span class="st">&quot;fr_FR&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.Date</code></pre></div>
<p>Il ne reste plus qu’à combiner les différents résultats de nos récupérations, de les ordonner par date de publication, puis d’harmoniser les mots-clés a minima, en supprimant les traits d’union et en s’assurant qu’ils ne contiennent pas de lettres majuscules :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d =<span class="st"> </span><span class="kw">rbind</span>(d1, d2, d3) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(date)
d<span class="op">$</span>tags =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;-&quot;</span>, <span class="st">&quot; &quot;</span>, d<span class="op">$</span>tags) <span class="op">%&gt;%</span><span class="st"> </span>tolower</code></pre></div>
<p>L’inspection du résultat montre que l’on dispose à présent d’un jeu de données contenant les métadonnées de 1,268 billets de blogs, dont l’immense majorité proviennent de <a href="http://www.conspiracywatch.info/">Conspiracy Watch</a> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nombre de billets récupérés</span>
<span class="kw">nrow</span>(d)
<span class="co"># sources des billets</span>
<span class="kw">table</span>(<span class="kw">substr</span>(d<span class="op">$</span>url, <span class="dv">1</span>, <span class="dv">25</span>))</code></pre></div>
<p>Il ne reste plus qu’à sauvegarder ce résultat, pour réutilisation future :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write_csv</span>(d, <span class="st">&quot;data/conspi.csv&quot;</span>)</code></pre></div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Si vous ne connaissez rien aux langages HTML et CSS, c’est le moment ou jamais d’en apprendre les bases ! Un excellent site de référence pour ce faire est <a href="http://www.w3schools.com/">W3 Schools</a>.<a href="#fnref1">↩</a></p></li>
</ol>
</div>

</article>
</div>

<div class="col-sm-3" role="complementary">
<nav class="hidden-print hidden-xs" id="nav_sidebar">
</nav>
</div>

</div>

<script>
// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname;
    href = href.substr(href.lastIndexOf('/') + 1);
    if (href=='') href = 'index.html';
    $('a[href="' + href + '"]').parent().addClass('active');
    $('a[href="' + href + '"]').parent().parents('li').addClass('active');

    // élargir la page d'accueil
    if (href=='index.html') $('.col-sm-9').attr('class','col-sm-12');

    // rechercher
    $("#rechercher").submit(function(event) {
      $('input[name="q"]').val($('input[name="q"]').val() + ' site:larmarange.github.io/analyse-R');
    });

    // sidebar
    $("#nav_sidebar").append($("#TOC").html());
    $("#nav_sidebar ul").addClass("nav nav-stacked");
    $("#TOC").addClass("visible-xs-block");
    $('body').scrollspy({
      target: '#nav_sidebar',
      offset: 40
    });

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation et tooltip
    $("code[data-pkg]").each(function( index ) {
      pkg = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
      } else {
        rdocumentation = $(this).text();
      }
      fonction = $(this).text();
      $(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pkg+'/functions/'+rdocumentation+'">');
      $(this).attr('data-toggle','tooltip');
      $(this).attr('data-placement','top');
      $(this).attr('title','package : ' + pkg);
      $('[data-toggle="tooltip"]').tooltip();
    });

    $("code.pkg").each(function( index ) {
      $(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
    });

    // Figures
    $("figure").each(function( index ) {
      if ($(this).children("figcaption").length > 0)
        $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
      else
        $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
    });

    // Colorbox
    jQuery('article div img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).attr('alt');
      }
    });
    jQuery('article div img').css('cursor', 'pointer');
    jQuery('figure img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).parent().children("figcaption").text();
      }
    });
    jQuery('figure img').css('cursor', 'pointer');

    // ZeroClipboard
    $('pre.r').parent().each(function(){
      $(this).children('pre.r').first().before('<div class="zero-clipboard hidden-print hidden-xs"><button class="btn-clipboard">Copier</button></div>');
    }); // Il peut arriver que le pre ne soit pas précédé (cf. figures)
    $('*:not(pre):not(.zero-clipboard) + pre.r').before('<div class="zero-clipboard hidden-print hidden-xs"><button class="btn-clipboard">Copier</button></div>');
    $('pre.last').after(function() {
      if ($(this).hasClass("r")) res = $(this).text(); else res = "";
      $(this).prevUntil('*:not(pre)','pre.r').each(function() {
        res = $(this).text() + '\n' + res;
      });
      return '<div class="clipboard">' + res + '</div>';
    });
    $('.zero-clipboard').each(function(index){
      $(this).children('.btn-clipboard').attr('data-clipboard-target','clipboard_'+index);
      $(this).nextAll("div.clipboard").first().attr('id','clipboard_'+index);
    });
    var client = new ZeroClipboard( $(".btn-clipboard") );
    client.on( "ready", function( readyEvent ) {
      // alert( "ZeroClipboard SWF is ready!" );
      client.on( "aftercopy", function( event ) {
        // `this` === `client`
        // `event.target` === the element that was clicked
        //event.target.style.display = "none";
        $(event.target).parent().before('<div class="alert alert-success"><a href="#" class="close" data-dismiss="alert">&times;</a>Le code <strong>R</strong> de l’exemple a été copié dans le presse-papier.</div>');
      } );
    } );

});
</script>

<!-- disqus -->
<div class="row">
  <div id="disqus_thread" class="col-sm-9" role="complementary"></div>
</div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'analyse-r'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Veuillez activer JavaScript pour voir les <a href="http://disqus.com/?ref_noscript">les commentaires gérés avec Disqus.</a></noscript>
    <!--<a href="http://disqus.com" class="dsq-brlink">Les commentaires sont hébergés par <span class="logo-disqus">Disqus</span>.</a>-->

<footer>
  <div class="row">
    <div class="col-lg-12">
      <p>Contenus sous licence <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" rel="nofollow">Creative Commons Attribution - Pas d’utilisation commerciale - Partage dans les mêmes conditions</a>.<br />
      Propulsé par <a href="http://www.r-project.org/" rel="nofollow">R</a>, </a><a href="http://www.rstudio.com/" rel="nofollow">RStudio</a>, <a href="http://rmarkdown.rstudio.com/" rel="nofollow">R Markdown</a>, <a href="http://yihui.name/knitr/" rel="nofollow">knitr</a>, <a href="http://pandoc.org/" rel="nofollow">pandoc</a> et <a href="http://www.princexml.com/" rel="nofollow">Prince XML</a>. Hébergé par <a href="https://github.com/" rel="nofollow">GitHub</a>.</p>
    </div>
  </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
